###############################################################################
#                            generated by chef
###############################################################################

listen heat-api
  bind <%= @vip %>:8004 ssl crt /etc/haproxy/haproxy.pem
  balance source
  option tcpka
  option httpchk
  option httplog
  option forwardfor
  reqadd X-Forwarded-Proto:\ https
<% @headnodes.each do |n| -%>
  server <%= n['hostname'] %> <%= n['service_ip'] %>:8004 check inter 5s rise 1 fall 1
<% end -%>

listen heat-api-cfn
  bind <%= @vip %>:8000 ssl crt /etc/haproxy/haproxy.pem
  balance source
  option tcpka
  option httpchk
  option httplog
  option forwardfor
  reqadd X-Forwarded-Proto:\ https
<% @headnodes.each do |n| -%>
  server <%= n['hostname'] %> <%= n['service_ip'] %>:8000 check inter 5s rise 1 fall 1
<% end -%>
